#!/usr/bin/env sh

# Skip commitlint for release commits
COMMIT_MSG=$(cat "$1")
if echo "$COMMIT_MSG" | grep -q "chore(release):"; then
  exit 0
fi

# Check if commitlint is installed
if [ ! -f node_modules/.bin/commitlint ]; then
  echo ""
  echo "commitlint is not installed. Please run: npm ci --include=dev"
  echo ""
  echo "To skip this check, use: git commit --no-verify"
  echo ""
  exit 1
fi

npx --no -- commitlint --edit $1 || {
  echo ""
  echo "To skip this check, use: git commit --no-verify"
  echo ""
  exit 1
}