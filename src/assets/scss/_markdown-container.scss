@use 'sass:map';
@use 'helpers';
@use 'variables';

.markdown-container :not(.chaise-file-preview-container):not(.chaise-file-preview-container *) {
  // NOTE related PR: https://github.com/informatics-isi-edu/chaise/pull/882
  // might not be needed anymore
  .recordset-table td & img {
    overflow-x: hidden;
  }

  & > p:last-child {
    margin-bottom: 0;
  }

  code {
    padding-left: 0;
    padding-right: 0;
    color: #333;
    background-color: #f5f5f5;
  }

  img {
    margin: 5px 5px 5px 0;
  }

  figure {
    /**
     * bootstrap 5 is adding a margin that we want to override.
     * adding this ensures two images side by side are aligned properly.
     */
    margin: unset;

    overflow-x: auto;
    figcaption {
      min-height: 20px;
    }

    .figcaption-wrapper {
      // min height should include enough space for the button height and the margin above
      min-height: 40px;

      figcaption {
        display: inline;
      }
    }

    .iframe-btn-container {
      float: right;
      text-align: right;
      margin-top: 10px;

      .chaise-btn.chaise-btn-iframe {
        border: 2px solid #ccc;
        border-bottom: none;
        border-bottom-right-radius: 0px;
        border-bottom-left-radius: 0px;
      }

      .chaise-btn-iframe:hover {
        text-decoration: none;
      }
    }

    &.fullscreen-off {
      .iframe-btn-container {
        display: none;
      }
    }

    // override the browser's default border
    iframe {
      border: 2px solid #ccc;
    }
  }

  .chaise-autofill {
    height: 90%;
    height: -webkit-fill-available;
    height: -moz-available;
    width: 100%;
    width: -webkit-fill-available;
    width: -moz-available;
  }

  // chaise-color-preview
  .chaise-color-preview {
    display: inline-block;
    height: 11px;
    width: 11px;
    border-radius: 3px;
    border: 1px solid map.get(variables.$color-map, 'black');
  }

  .vocab {
    color: map.get(variables.$color-map, 'vocab');
    background-color: map.get(variables.$color-map, 'vocab-background');
    padding: 7px;
    border-radius: 10px;
    display: inline-block;
    margin: 2px;
  }

  // some iframe content has a <h3> then <p> tag before the iframe
  // the following 2 classes can be used to reduce the space between the content
  // <h3> has margin-bottom: 16px; by default
  .chaise-reduce-header-margin {
    margin-bottom: 5px;
  }

  // reduce the margin to a negative number to "pull" the iframe content closer to the text
  .chaise-iframe-after {
    margin-bottom: -8px;
  }

  ul.chaise-list-csv {
    list-style: none;
    display: inline;
    li {
      display: inline;
      > p {
        display: inline;
      }

      margin: 0 !important;

      &:after {
        content: ", ";
      }
      &:last-child:after {
        content: "";
      }
    }
  }

  a.download {
    @include helpers.chaise-btn();
    @include helpers.chaise-btn-primary();

    // override the button style and allow user text selection
    user-select: auto;
    -webkit-user-select: auto;
    -moz-user-select: auto;
    -ms-user-select: auto;
  }

  a.download-alt:not(.download), a[download]:not(.download) {
    @include helpers.download-btn();
  }

  .asset-source-description {
    font-size: 85%;
  }

  .chaise-gene-sequence {
    counter-reset: sequence;
    font-family: Courier, monospace;
    background-color: map.get(variables.$color-map, 'code-block-background-in-md');
    padding-top: 10px;

    // added for recordset tables, might not be needed
    min-width: 300px;

    .chaise-gene-sequence-chunk {
      display: inline-block;
      margin: 1rem 0 0.5rem 1rem;
      position: relative;
      white-space: nowrap;

      &:not(:last-child)::before {
        content: counter(sequence);
        counter-increment: sequence 10;
        position: absolute;
        top: -1em;
        right: 0;
        opacity: .7;
      }
    }

    &.chaise-gene-sequence-compact {
      padding-top: 0;
      .chaise-gene-sequence-chunk {
        margin: 1rem 0 0 0.5rem;
      }
    }
  }

  ul {
    list-style-type: disc;
  }

  ol {
    list-style-type: decimal;
  }

  ol,
  ul {
    padding: 0 !important;
    /*existing rule is padding=2, which should be changed for the other changes*/

    &:only-child {
      > li {
        // when there is only one list and one list item within it, hide the bullets
        &:only-child {
          margin-left: 0;
          list-style: none;
        }
      }
    }
    > li {
      margin-left: 1em;
      padding-left: 0;
      list-style: inherit;
    }
  }

  /*
    Markdown rendering style is based on github styling from https://github.com/sindresorhus/github-markdown-css/blob/gh-pages/github-markdown.css
    Changing this file will override any default style.
    Original code has a different name for the class, this has been changed to  markdown-container for chaise application.
  */

  hr::after,
  &::after {
    clear: both;
  }

  .pl-c {
    color: #6a737d;
  }

  .pl-c1,
  .pl-s .pl-v {
    color: #005cc5;
  }

  .pl-e,
  .pl-en {
    color: #6f42c1;
  }

  .pl-s .pl-s1,
  .pl-smi {
    color: #24292e;
  }

  .pl-ent {
    color: #22863a;
  }

  .pl-k {
    color: #d73a49;
  }

  .pl-pds,
  .pl-s,
  .pl-s .pl-pse .pl-s1,
  .pl-sr,
  .pl-sr .pl-cce,
  .pl-sr .pl-sra,
  .pl-sr .pl-sre {
    color: #032f62;
  }

  .pl-smw,
  .pl-v {
    color: #e36209;
  }

  .pl-bu {
    color: #b31d28;
  }

  .pl-ii {
    color: #fafbfc;
    background-color: #b31d28;
  }

  .pl-c2 {
    color: #fafbfc;
    background-color: #d73a49;
  }

  .pl-c2::before {
    content: "^M";
  }

  .pl-sr .pl-cce {
    font-weight: 700;
    color: #22863a;
  }

  .pl-ml {
    color: #735c0f;
  }

  .pl-mh,
  .pl-mh .pl-en,
  .pl-ms {
    font-weight: 700;
    color: #005cc5;
  }

  .pl-mi {
    font-style: italic;
    color: #24292e;
  }

  .pl-mb {
    font-weight: 700;
    color: #24292e;
  }

  .pl-md {
    color: #b31d28;
    background-color: #ffeef0;
  }

  .pl-mi1 {
    color: #22863a;
    background-color: #f0fff4;
  }

  .pl-mc {
    color: #e36209;
    background-color: #ffebda;
  }

  .pl-mi2 {
    color: #f6f8fa;
    background-color: #005cc5;
  }

  .pl-mdr {
    font-weight: 700;
    color: #6f42c1;
  }

  .pl-ba {
    color: #586069;
  }

  .pl-sg {
    color: #959da5;
  }

  .pl-corl {
    text-decoration: underline;
    color: #032f62;
  }

  .octicon {
    display: inline-block;
    fill: currentColor;
    vertical-align: text-bottom;
  }

  hr::after,
  hr::before,
  &::after,
  &::before {
    display: table;
    content: "";
  }

  a {
    background-color: transparent;
    color: #0366d6;
    text-decoration: none;
  }

  a:active,
  a:hover {
    outline-width: 0;
  }

  h1 {
    margin: 0.67em 0;
  }

  img {
    border-style: none;
  }

  hr {
    box-sizing: content-box;
  }

  input {
    font: inherit;
    margin: 0;
    overflow: visible;
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
  }

  dl dt,
  strong,
  table th {
    font-weight: 600;
  }

  code,
  pre {
    font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace;
  }

  [type="checkbox"] {
    box-sizing: border-box;
    padding: 0;
  }

  * {
    box-sizing: border-box;
  }

  a:hover {
    text-decoration: underline;
  }

  td,
  th {
    padding: 0;
  }

  blockquote {
    margin: 0;
  }

  ol ol,
  ul ol {
    list-style-type: lower-roman;
  }

  ol ol ol,
  ol ul ol,
  ul ol ol,
  ul ul ol {
    list-style-type: lower-alpha;
  }

  dd {
    margin-left: 0;
  }

  .pl-0 {
    padding-left: 0 !important;
  }

  .pl-1 {
    padding-left: 4px !important;
  }

  .pl-2 {
    padding-left: 8px !important;
  }

  .pl-3 {
    padding-left: 16px !important;
  }

  .pl-4 {
    padding-left: 24px !important;
  }

  .pl-5 {
    padding-left: 32px !important;
  }

  .pl-6 {
    padding-left: 40px !important;
  }

  > :first-child {
    margin-top: 0 !important;
  }

  > :last-child {
    margin-bottom: 0 !important;
  }

  a:not([href]) {
    color: inherit;
    text-decoration: none;
  }

  .anchor {
    float: left;
    padding-right: 4px;
    margin-left: -20px;
    line-height: 1;
  }

  .anchor:focus {
    outline: 0;
  }

  blockquote,
  dl,
  ol,
  p,
  pre,
  table,
  ul {
    margin-top: 0;
    // changed the following from 16 to 8
    // in the cases that there's just a single p and ul,
    // the space between them were too much, so we reduced it.
    // we couldn't reduce this any further since in the cases of multiple p,
    // they would be too close each other and it was hard to read.
    margin-bottom: 8px;
  }

  hr {
    overflow: hidden;
    background: #e1e4e8;
    height: 0.25em;
    padding: 0;
    margin: 24px 0;
    border: 0;
  }

  blockquote {
    padding: 0 1em;
    color: #6a737d;
    border-left: 0.25em solid #dfe2e5;
  }

  h1,
  h2 {
    padding-bottom: 0.3em;
    border-bottom: 1px solid #eaecef;
  }

  blockquote > :first-child {
    margin-top: 0;
  }

  blockquote > :last-child {
    margin-bottom: 0;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    margin-top: 24px;
    margin-bottom: 16px;
    font-weight: 600;
    line-height: 1.25;
  }

  h1 .octicon-link,
  h2 .octicon-link,
  h3 .octicon-link,
  h4 .octicon-link,
  h5 .octicon-link,
  h6 .octicon-link {
    color: #1b1f23;
    vertical-align: middle;
    visibility: hidden;
  }

  h1:hover .anchor,
  h2:hover .anchor,
  h3:hover .anchor,
  h4:hover .anchor,
  h5:hover .anchor,
  h6:hover .anchor {
    text-decoration: none;
  }

  h1:hover .anchor .octicon-link,
  h2:hover .anchor .octicon-link,
  h3:hover .anchor .octicon-link,
  h4:hover .anchor .octicon-link,
  h5:hover .anchor .octicon-link,
  h6:hover .anchor .octicon-link {
    visibility: visible;
  }

  h1 {
    font-size: 2em;
  }

  h2 {
    font-size: 1.5em;
  }

  h3 {
    font-size: 1.25em;
  }

  h4 {
    font-size: 1em;
  }

  h5 {
    font-size: 0.875em;
  }

  h6 {
    font-size: 0.85em;
    color: #6a737d;
  }

  ol,
  ul {
    padding-left: 2em;
  }

  ol ol,
  ol ul,
  ul ol,
  ul ul {
    margin-top: 0;
    margin-bottom: 0;
  }

  li {
    word-wrap: break-all;
  }

  li > p {
    margin-top: 16px;
  }

  li + li {
    margin-top: 0.25em;
  }

  dl {
    padding: 0;
  }

  dl dt {
    padding: 0;
    margin-top: 16px;
    font-size: 1em;
    font-style: italic;
  }

  dl dd {
    padding: 0 16px;
    margin-bottom: 16px;
  }

  table {
    border-spacing: 0;
    border-collapse: collapse;
    display: block;
    width: 100%;
    overflow: auto;
  }

  table td,
  table th {
    padding: 6px 13px;
    border: 1px solid #dfe2e5;
  }

  table tr {
    background-color: #fff;
    border-top: 1px solid #c6cbd1;
  }

  table tr:nth-child(2n) {
    background-color: #f6f8fa;
  }

  img {
    max-width: 100%;
    box-sizing: content-box;
    background-color: #fff;
  }

  img[align="right"] {
    padding-left: 20px;
  }

  img[align="left"] {
    padding-right: 20px;
  }

  code {
    padding: 0.2em 0.4em;
    margin: 0;
    font-size: 85%;
    background-color: rgba(27, 31, 35, 0.05);
    border-radius: 3px;
  }

  pre {
    word-wrap: normal;
  }

  pre > code {
    padding: 0;
    margin: 0;
    font-size: 100%;
    word-break: normal;
    white-space: pre;
    background: 0 0;
    border: 0;
  }

  .highlight {
    margin-bottom: 16px;
  }

  .highlight pre {
    margin-bottom: 0;
    word-break: normal;
  }

  .highlight pre,
  pre {
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f6f8fa;
    border-radius: 3px;
  }

  pre code {
    display: inline;
    max-width: auto;
    padding: 0;
    margin: 0;
    overflow: visible;
    line-height: inherit;
    word-wrap: normal;
    background-color: transparent;
    border: 0;
  }

  .full-commit .btn-outline:not(:disabled):hover {
    color: #005cc5;
    border-color: #005cc5;
  }

  kbd {
    display: inline-block;
    padding: 3px 5px;
    font: 11px SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace;
    line-height: 10px;
    color: #444d56;
    vertical-align: middle;
    background-color: #fafbfc;
    border: 1px solid #d1d5da;
    border-bottom-color: #c6cbd1;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 #c6cbd1;
  }

  &:checked + .radio-label {
    position: relative;
    z-index: map.get(variables.$z-index-map, 'markdown-container-radio-label');
    border-color: #0366d6;
  }

  .task-list-item {
    list-style-type: none;
  }

  .task-list-item + .task-list-item {
    margin-top: 3px;
  }

  .task-list-item input {
    margin: 0 0.2em 0.25em -1.6em;
    vertical-align: middle;
  }

  hr {
    border-bottom-color: #eee;
  }
// }
}
