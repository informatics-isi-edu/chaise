<html ng-app="chaise.viewer">
<head>
    <title>Image Viewer</title>
    %ASSETS%
    <meta http-equiv="X-UA-Compatible" content="IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
    <!--
        IE8 support, see AngularJS Internet Explorer Compatibility http://docs.angularjs.org/guide/ie
        For Firefox 3.6, you will also need to include jQuery and ECMAScript 5 shim
    -->
    <!--[if lt IE 9]>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/es5-shim/2.2.0/es5-shim.js"></script>
        <script>
            document.createElement('ui-select');
            document.createElement('ui-select-match');
            document.createElement('ui-select-choices');
        </script>
    <![endif]-->
</head>
<body>
    <div class="container-fluid">
        <div ng-controller="AlertsController as alerts" id="alert" class="row">
            <div class="col-md-12">
                <div ng-repeat="alert in alerts.alerts" class="alert alert-dismissable" ng-class="{'alert-danger': alert.type == 'error'}" role="alert">
                    <button ng-click="alerts.closeAlert(alert);" type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <strong>{{alert.type | toTitleCase}}:</strong> {{alert.message}}
                </div>
            </div>
        </div>
        <div class="row">
            <!-- CONTROLLER: SidebarController -->
            <div ng-controller="SidebarController as sidebar" id="sidebar" class="col-md-3">
                <div class="row">
                    <ul class="nav nav-tabs">
                        <li ng-repeat="panel in sidebar.sidebars" ng-class="{active: sidebar.sidebar == panel}" role="presentation">
                            <a ng-click="sidebar.setSidebar(panel);">{{panel | toTitleCase}}</a>
                        </li>
                    </ul>
                </div>
                <br>
                <!-- CONTROLLER: ImageMetadataController-->
                <div ng-show="sidebar.sidebar == 'metadata'" ng-controller="ImageMetadataController as metadata" id="metadata-panel" class="row">
                    <div class="col-md-12">
                        <div ng-if="metadata.allowEdit();" class="row">
                            <div class="col-md-12">
                                <button ng-show="!metadata.editMode" ng-click="metadata.edit();" class="btn btn-sm btn-success form-control" type="button" role="button">
                                    <span class="glyphicon glyphicon-pencil"></span>&nbsp;&nbsp;&nbsp;Edit Metadata
                                </button>
                                <button ng-show="metadata.editMode" ng-click="metadata.save();" class="btn btn-sm btn-success form-control" type="button" role="button">
                                    <span class="glyphicon glyphicon-ok"></span>&nbsp;&nbsp;&nbsp;Save Metadata
                                </button>
                            </div>
                            <br>
                        </div>
                        <table class="table">
                            <tbody>
                                <tr>
                                    <td class="entity-key col-md-2">Slide ID</td>
                                    <td class="entity-value col-md-10">
                                        <span ng-if="metadata.image.entity.data.slide_id">{{metadata.image.entity.data.slide_id}}</span>
                                        <span ng-if="!metadata.image.entity.data.slide_id" class="text-muted">No data</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">Status</td>
                                    <td class="entity-value col-md-10">
                                        <div ng-show="!metadata.editMode">
                                            <span ng-if="metadata.image.entity.data.status">{{metadata.image.entity.data.status}}</span>
                                            <span ng-if="!metadata.image.entity.data.status" class="text-muted">No data</span>
                                        </div>
                                        <div ng-show="metadata.editMode" class="form-inline">
                                            <ui-select ng-model="metadata.image.entity.data.status" theme="select2" ng-disabled="disabled" style="width: 175px;">
                                                <ui-select-match placeholder="Select a term">{{metadata.image.entity.data.status}}</ui-select-match>
                                                <ui-select-choices repeat="status in (metadata.statuses | filter: $select.search) track by status">
                                                    <div ng-bind-html="status | highlight: $select.search"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">Description</td>
                                    <td class="entity-value col-md-10">
                                        <div ng-show="!metadata.editMode">
                                            <span ng-if="metadata.image.entity.data.description">{{metadata.image.entity.data.description}}</span>
                                            <span ng-if="!metadata.image.entity.data.description" class="text-muted">No data</span>
                                        </div>
                                        <div ng-show="metadata.editMode" class="form-inline">
                                            <textarea ng-model="metadata.image.entity.data.description" class="form-control" rows="5"></textarea>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">Submitter</td>
                                    <td class="entity-value col-md-10">
                                        <span ng-if="metadata.image.entity.data.submitter">{{metadata.image.entity.data.submitter}}</span>
                                        <span ng-if="!metadata.image.entity.data.submitter" class="text-muted">No data</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">Submitted</td>
                                    <td class="entity-value col-md-10">
                                        <span ng-if="metadata.image.entity.data.submitted">{{metadata.image.entity.data.submitted}}</span>
                                        <span ng-if="!metadata.image.entity.data.submitted" class="text-muted">No data</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <br>
                        <h4>Tags</h4>
                        <table class="table">
                            <tbody>
                                <tr>
                                    <td class="entity-key col-md-2">Tissue</td>
                                    <td class="entity-value col-md-10">
                                        <div ng-show="!metadata.editMode">
                                            <span ng-if="metadata.image.entity.data.tissue">{{metadata.image.entity.data.tissue}}</span>
                                            <span ng-if="!metadata.image.entity.data.tissue" class="text-muted">No data</span>
                                        </div>
                                        <div ng-show="metadata.editMode" class="form-inline">
                                            <ui-select ng-model="metadata.image.entity.data.tissue" theme="select2" ng-disabled="disabled" style="width: 175px;">
                                                <ui-select-match placeholder="Select a term">{{metadata.image.entity.data.tissue}}</ui-select-match>
                                                <ui-select-choices repeat="tissue in (metadata.vocabs.tissue | filter: $select.search) track by tissue">
                                                    <div ng-bind-html="tissue | highlight: $select.search"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">Gender</td>
                                    <td class="entity-value col-md-10">
                                        <div ng-show="!metadata.editMode">
                                            <span ng-if="metadata.image.entity.data.gender">{{metadata.image.entity.data.gender}}</span>
                                            <span ng-if="!metadata.image.entity.data.gender" class="text-muted">No data</span>
                                        </div>
                                        <div ng-show="metadata.editMode" class="form-inline">
                                            <ui-select ng-model="metadata.image.entity.data.gender" theme="select2" ng-disabled="disabled" style="width: 175px;">
                                                <ui-select-match placeholder="Select a term">{{metadata.image.entity.data.gender}}</ui-select-match>
                                                <ui-select-choices repeat="gender in (metadata.vocabs.gender | filter: $select.search) track by gender">
                                                    <div ng-bind-html="gender | highlight: $select.search"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">Age Stage</td>
                                    <td class="entity-value col-md-10">
                                        <div ng-show="!metadata.editMode">
                                            <span ng-if="metadata.image.entity.data.age_stage">{{metadata.image.entity.data.age_stage}}</span>
                                            <span ng-if="!metadata.image.entity.data.age_stage" class="text-muted">No data</span>
                                        </div>
                                        <div ng-show="metadata.editMode" class="form-inline">
                                            <ui-select ng-model="metadata.image.entity.data.age_stage" theme="select2" ng-disabled="disabled" style="width: 175px;">
                                                <ui-select-match placeholder="Select a term">{{metadata.image.entity.data.age_stage}}</ui-select-match>
                                                <ui-select-choices repeat="age_stage in (metadata.vocabs.age_stage | filter: $select.search) track by age_stage">
                                                    <div ng-bind-html="age_stage | highlight: $select.search"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">Embedding Medium</td>
                                    <td class="entity-value col-md-10">
                                        <div ng-show="!metadata.editMode">
                                            <span ng-if="metadata.image.entity.data.embedding_medium">{{metadata.image.entity.data.embedding_medium}}</span>
                                            <span ng-if="!metadata.image.entity.data.embedding_medium" class="text-muted">No data</span>
                                        </div>
                                        <div ng-show="metadata.editMode" class="form-inline">
                                            <ui-select ng-model="metadata.image.entity.data.embedding_medium" theme="select2" ng-disabled="disabled" style="width: 175px;">
                                                <ui-select-match placeholder="Select a term">{{metadata.image.entity.data.embedding_medium}}</ui-select-match>
                                                <ui-select-choices repeat="embedding_medium in (metadata.vocabs.embedding_medium | filter: $select.search) track by embedding_medium">
                                                    <div ng-bind-html="embedding_medium | highlight: $select.search"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">Specimen Fixation</td>
                                    <td class="entity-value col-md-10">
                                        <div ng-show="!metadata.editMode">
                                            <span ng-if="metadata.image.entity.data.specimen_fixation">{{metadata.image.entity.data.specimen_fixation}}</span>
                                            <span ng-if="!metadata.image.entity.data.specimen_fixation" class="text-muted">No data</span>
                                        </div>
                                        <div ng-show="metadata.editMode" class="form-inline">
                                            <ui-select ng-model="metadata.image.entity.data.specimen_fixation" theme="select2" ng-disabled="disabled" style="width: 175px;">
                                                <ui-select-match placeholder="Select a term">{{metadata.image.entity.data.specimen_fixation}}</ui-select-match>
                                                <ui-select-choices repeat="specimen_fixation in (metadata.vocabs.specimen_fixation | filter: $select.search) track by specimen_fixation">
                                                    <div ng-bind-html="specimen_fixation | highlight: $select.search"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">Staining Protocol</td>
                                    <td class="entity-value col-md-10">
                                        <div ng-show="!metadata.editMode">
                                            <span ng-if="metadata.image.entity.data.staining_protocol">{{metadata.image.entity.data.staining_protocol}}</span>
                                            <span ng-if="!metadata.image.entity.data.staining_protocol" class="text-muted">No data</span>
                                        </div>
                                        <div ng-show="metadata.editMode" class="form-inline">
                                            <ui-select ng-model="metadata.image.entity.data.staining_protocol" theme="select2" ng-disabled="disabled" style="width: 175px;">
                                                <ui-select-match placeholder="Select a term">{{metadata.image.entity.data.staining_protocol}}</ui-select-match>
                                                <ui-select-choices repeat="staining_protocol in (metadata.vocabs.staining_protocol | filter: $select.search) track by staining_protocol">
                                                    <div ng-bind-html="staining_protocol | highlight: $select.search"></div>
                                                </ui-select-choices>
                                            </ui-select>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <br>
                        <h4>File Details</h4>
                        <table class="table">
                            <tbody>
                                <tr>
                                    <td class="entity-key col-md-2">Filename</td>
                                    <td class="entity-value col-md-10">
                                        <span ng-if="metadata.image.entity.data.filename">{{metadata.image.entity.data.filename}}</span>
                                        <span ng-if="!metadata.image.entity.data.filename" class="text-muted">No data</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">Resolution</td>
                                    <td class="entity-value col-md-10">
                                        <span ng-if="metadata.image.entity.data.resolution">{{metadata.image.entity.data.resolution}}</span>
                                        <span ng-if="!metadata.image.entity.data.resolution" class="text-muted">No data</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">Bytes</td>
                                    <td class="entity-value col-md-10">
                                        <span ng-if="metadata.image.entity.data.bytes">{{metadata.image.entity.data.bytes}}</span>
                                        <span ng-if="!metadata.image.entity.data.bytes" class="text-muted">No data</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <br>
                        <h4>Identifiers</h4>
                        <table class="table">
                            <tbody>
                                <tr>
                                    <td class="entity-key col-md-2">Accession Number</td>
                                    <td class="entity-value col-md-10">
                                        <div ng-show="!metadata.editMode">
                                            <span ng-if="metadata.image.entity.data.accession_number">{{metadata.image.entity.data.description}}</span>
                                            <span ng-if="!metadata.image.entity.data.accession_number" class="text-muted">No data</span>
                                        </div>
                                        <div ng-show="metadata.editMode" class="form-inline">
                                            <input ng-model="metadata.image.entity.data.accession_number" type="text" class="form-control">
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">DOI</td>
                                    <td class="entity-value col-md-10">
                                        <div ng-show="!metadata.editMode">
                                            <span ng-if="metadata.image.entity.data.doi">{{metadata.image.entity.data.doi}}</span>
                                            <span ng-if="!metadata.image.entity.data.doi" class="text-muted">No data</span>
                                        </div>
                                        <div ng-show="metadata.editMode" class="form-inline">
                                            <input ng-model="metadata.image.entity.data.doi" type="text" class="form-control">
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="entity-key col-md-2">ARK</td>
                                    <td class="entity-value col-md-10">
                                        <div ng-show="!metadata.editMode">
                                            <span ng-if="metadata.image.entity.data.ark">{{metadata.image.entity.data.ark}}</span>
                                            <span ng-if="!metadata.image.entity.data.ark" class="text-muted">No data</span>
                                        </div>
                                        <div ng-show="metadata.editMode" class="form-inline">
                                            <input ng-model="metadata.image.entity.data.ark" type="text" class="form-control">
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- CONTROLLER: AnnotationsController-->
                <div ng-show="sidebar.sidebar == 'annotations'" ng-controller="AnnotationsController as annotations" id="annotations-panel" class="row">
                    <div class="col-md-12">
                        <div ng-if="annotations.allowCreate();" class="row">
                            <div class="btn-group col-md-12">
                                <button type="button" role="button" class="btn btn-sm btn-success dropdown-toggle form-control" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    New Annotation&nbsp;&nbsp;<span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a ng-click="annotations.drawAnnotation('section_annotation');">Section of Interest</a></li>
                                    <li><a ng-click="annotations.drawAnnotation('annotation');">Regular Annotation</a></li>
                                    <li><a ng-click="annotations.drawAnnotation('arrow_annotation');">Arrow Annotation</a></li>
                                </ul>
                            </div>
                        </div>
                        <br>
                        <div class="row">
                            <div class="col-md-12">
                                <input ng-model="annotations.query" class="form-control" type="search" placeholder="Type to search...">
                            </div>
                        </div>
                        <br>
                        <!-- Annotation Creation Form -->
                        <form ng-show="annotations.createMode" id="create-annotation-form" class="annotation">
                            <div class="row">
                                <div class="col-md-10">
                                    <span class="h4">New
                                        <span ng-if="annotations.newAnnotationType == 'section_annotation'">Section of Interest</span>
                                        <span ng-if="annotations.newAnnotationType == 'annotation'">Regular Annotation</span>
                                        <span ng-if="annotations.newAnnotationType == 'arrow_annotation'">Arrow Annotation</span>
                                    </span>
                                </div>
                                <div class="col-md-2">
                                    <button ng-click="annotations.cancelNewAnnotation();" type="button" class="close pull-right" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-12">
                                    <label>Description</label>
                                    <textarea ng-model="annotations.newAnnotation.description" class="form-control description-field" rows="3" placeholder="Write annotation text here."></textarea>
                                    <div ng-if="annotations.newAnnotationType != 'section_annotation'">
                                        <br>
                                        <label>Anatomy</label>
                                        <ui-select ng-model="annotations.newAnnotation.anatomy" theme="select2" ng-disabled="disabled">
                                            <ui-select-match placeholder="Select an anatomy term">{{annotations.newAnnotation.anatomy}}</ui-select-match>
                                            <ui-select-choices repeat="anatomy in (annotations.anatomies | filter: $select.search) track by anatomy">
                                                <div ng-bind-html="anatomy | highlight: $select.search"></div>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                </div>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-md-12">
                                    <button ng-click="annotations.createAnnotation();" role="button" class="btn btn-xs btn-success form-control" type="submit">
                                        <strong>Submit</strong>
                                    </button>
                                </div>
                            </div>
                        </form>
                        <!-- Sections List -->
                        <div ng-repeat="section in annotations.sections | orderBy:['-data.created', '-data.id'] | filter:annotations.filterAnnotations(['description', 'anatomy', 'author', 'created'])"
                         ng-class="{highlighted: annotations.highlightedAnnotation == (section.table.name + '-' + section.data.id)}"
                          class="annotation section" id="{{section.table.name + '-' + section.data.id}}">
                            <div ng-show="annotations.editedAnnotation != (section.table.name + '-' + section.data.id)">
                                <div class="row">
                                    <div class="col-md-3">
                                        <span class="label label-success">{{'Section' | uppercase}}</span>
                                    </div>
                                    <div class="col-md-9">
                                        <small class="pull-right">
                                            <a ng-click="annotations.centerAnnotation(section)" title="Center Section" class="cardlink">Focus</a>
                                            <span ng-if="annotations.allowEdit(section);">
                                                | <a ng-click="annotations.editAnnotation(section);" title="Edit Annotation" class="cardlink">Edit</a>
                                            </span>
                                            <span ng-if="annotations.allowDelete(section);">
                                                | <a ng-if="annotations.allowDelete(section);" ng-click="annotations.deleteAnnotation(section);" title="Delete Annotation" class="cardlink delete">Delete</a>
                                            </span>
                                        </small>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-12">
                                        <span class="h5 annotation-description">
                                            {{section.data.description}}
                                        </span>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-12">
                                        <small>{{section.data.author}} &mdash; {{section.data.created | date:'MMM d, y'}}</small>
                                    </div>
                                </div>
                            </div>
                            <form ng-show="annotations.editedAnnotation == (section.table.name + '-' + section.data.id)" id="edit-annotation-form">
                                <div class="row">
                                    <div class="col-md-10">
                                        <label>Description</label>
                                        <textarea ng-model="section.data.description" rows="3" class="form-control"></textarea>
                                    </div>
                                    <div class="col-md-2">
                                        <button ng-click="annotations.cancelEdit(annotation);" type="button" class="close pull-right" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-12">
                                        <small>
                                            {{section.data.author}} &mdash;
                                            {{section.data.created | date: 'MMM d, y'}}
                                        </small>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-12">
                                        <button ng-click="annotations.updateAnnotation(section);" role="button" class="btn btn-xs btn-primary form-control" type="button">
                                            Save
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <!-- Annotations List -->
                        <div ng-repeat="annotation in annotations.annotations | orderBy:['-data.created', '-data.id'] | filter:annotations.filterAnnotations(['description', 'anatomy', 'author', 'created']) track by $index"
                        ng-class="{highlighted: annotations.highlightedAnnotation == (annotation.table.name + '-' + annotation.data.id)}"
                        id="{{annotation.table.name + '-' + annotation.data.id}}" class="annotation">
                            <!-- Annotation Display Card -->
                            <div ng-show="annotations.editedAnnotation != (annotation.table.name + '-' + annotation.data.id)">
                                <div class="row">
                                    <!-- Annotation Anatomy Text -->
                                    <div class="col-md-7 annotation-anatomy-text">
                                        <small><strong>
                                            <span ng-if="annotation.data.anatomy">{{annotation.data.anatomy | uppercase}}</span>
                                            <span ng-if="!annotation.data.anatomy">{{'No Anatomy' | uppercase}}</span>
                                        </strong></small>
                                    </div>
                                    <!-- Annotation Edit/Delete Buttons -->
                                    <div class="col-md-5">
                                        <small class="pull-right">
                                            <a ng-click="annotations.centerAnnotation(annotation)" title="Center Annotation" class="cardlink">Focus</a>
                                            <span ng-if="annotations.allowEdit(annotation);">
                                                | <a ng-click="annotations.editAnnotation(annotation);" title="Edit Annotation" class="cardlink">Edit</a>
                                            </span>
                                            <span ng-if="annotations.allowDelete(annotation);">
                                                | <a ng-if="annotations.allowDelete(annotation);" ng-click="annotations.deleteAnnotation(annotation);" title="Delete Annotation" class="cardlink delete">Delete</a>
                                            </span>
                                        </small>
                                    </div>
                                </div>
                                <br>
                                <!-- Annotation Description -->
                                <div class="row">
                                    <div class="col-md-12">
                                        <span class="h5 annotation-description">
                                            {{annotation.data.description}}
                                        </span>
                                    </div>
                                </div>
                                <br>
                                <!-- Annotation Author, Date & Comment Icon -->
                                <div class="row">
                                    <div class="col-md-8">
                                        <small>{{annotation.data.author}} &mdash; {{annotation.data.created | date:'MMM d, y'}}</small>
                                    </div>
                                    <div class="col-md-4">
                                        <small class="pull-right">
                                            <span class="glyphicon glyphicon-comment"></span>
                                            {{annotations.getNumComments(annotation);}}
                                        </small>
                                    </div>
                                </div>
                                <div ng-if="annotations.getNumComments(annotation) !== 0">
                                    <div class="row">
                                        <hr class="separator">
                                    </div>
                                    <div ng-controller="CommentsController as comments" class="comments">
                                        <div ng-repeat="comment in comments.comments[comments.annotationId] | orderBy: ['data.created', 'data.id'] track by $index" class="row comment">
                                            <div class="col-md-12">
                                                <strong>{{comment.data.author}}</strong>
                                                <small><span class="text-muted pull-right">{{comment.data.created | date:'MMM d, y'}}</span></small>
                                                <br>{{comment.data.comment}}
                                                <div ng-if="comments.allowDelete(comment);">
                                                    <small>
                                                        <a ng-click="comments.deleteComment(comment);" class="cardlink delete">Delete</a>
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                        <div ng-if="comments.allowCreate();" class="row">
                                            <div class="col-md-12">
                                                <div class="comment-input">
                                                    <div class="input-group input-group-sm">
                                                        <input ng-focus="annotations.centerAnnotation(annotation);" ng-model="comments.newComment.comment" type="text" class="form-control" placeholder="Add a comment...">
                                                        <span class="input-group-btn">
                                                            <button ng-click="comments.createComment();" class="btn btn-success" type="submit" role="button">
                                                                Post
                                                            </button>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- /Comments section -->
                            </div><!-- /Annotation Display Card -->
                            <form ng-show="annotations.editedAnnotation == (annotation.table.name + '-' + annotation.data.id)" id="edit-annotation-form">
                                <div class="row">
                                    <!-- Edit Form: Annotation Anatomy -->
                                    <div class="col-md-10 annotation-anatomy-text">
                                        <label>Anatomy</label>
                                        <ui-select ng-model="annotation.data.anatomy" theme="select2" ng-disabled="disabled">
                                            <ui-select-match placeholder="Select an anatomy term">{{annotation.data.anatomy}}</ui-select-match>
                                            <ui-select-choices repeat="anatomy in (annotations.anatomies | filter: $select.search) track by anatomy">
                                                <div ng-bind-html="anatomy | highlight: $select.search"></div>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                    <div class="col-md-2">
                                        <button ng-click="annotations.cancelEdit(annotation);" type="button" class="close pull-right" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-12">
                                        <label>Description</label>
                                        <textarea ng-model="annotation.data.description" rows="3" class="form-control"></textarea>
                                    </div>
                                </div>
                                <br>
                                <!-- Edit Form: Annotation Author and Date -->
                                <div class="row">
                                    <div class="col-md-8">
                                        <small>
                                            {{annotation.data.author}} &mdash;
                                            {{annotation.data.created | date: 'MMM d, y'}}
                                        </small>
                                    </div>
                                    <div class="col-md-4">
                                        <small class="pull-right">
                                            <span class="glyphicon glyphicon-comment"></span>
                                            {{annotations.getNumComments(annotation);}}
                                        </small>
                                    </div>
                                </div>
                                <br>
                                <!-- Edit Form: Save buttons -->
                                <div class="row">
                                    <div class="col-md-12">
                                        <button ng-click="annotations.updateAnnotation(annotation);" role="button" class="btn btn-xs btn-primary form-control" type="button">
                                            Save
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div><!-- /Annotations List-->
                    </div>
                </div>
            </div><!--/ end SidebarController -->
            <!-- CONTROLLER: OSDController -->
            <div ng-controller="OSDController as osd" id="viewer" class="col-md-9">
                <div id="viewer-header" class="row">
                    <div class="col-md-6">
                        <span class="entity-title">
                            {{osd.image.entity.data.slide_id || 'No Slide ID'}}
                        </span>
                    </div>
                    <div class="col-md-6">
                        <span class="glyphicon glyphicon-info-sign pull-right" data-toggle="tooltip" title="<p class='text-left'><strong>Recommended browsers:</strong> Firefox and Chrome<br><br><strong>Safari users:</strong> The screenshot will be saved as 'Unknown.jpg'.</p>"></span>
                        <div class="btn-group btn-group-sm pull-right" role="group">
                            <button ng-click="osd.zoomInView();" class="btn btn-success" type="button" role="button">
                                <span class="glyphicon glyphicon-zoom-in"></span> Zoom In
                            </button>
                            <button ng-click="osd.zoomOutView();" class="btn btn-success" type="button" role="button">
                                <span class="glyphicon glyphicon-zoom-out"></span> Zoom Out
                            </button>
                            <button ng-click="osd.homeView();" class="btn btn-success" type="button" role="button">
                                <span class="glyphicon glyphicon-home"></span> Reset
                            </button>
                            <button ng-click="osd.downloadView();" class="btn btn-success" type="button" role="button">
                                <span class="glyphicon glyphicon-camera"></span> Take a Screenshot
                            </button>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <!-- Setting iframe height attr to 100% doesn't guarantee
                        it'll cover entire screen. Setting the height via style
                        attr apparently does. -->
                        <iframe id="osd" width="100%" src="about:blank" frameBorder="0" style="height:100vh;">
                            &lt;p&gt;Your browser does not support iframes.&lt;/p&gt;
                        </iframe>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
