<!DOCTYPE html>
<html ng-app="chaise.dataEntry">
<head>
    <title>Data Entry App</title>
    %ASSETS%
    <meta http-equiv="X-UA-Compatible" content="IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
    <!--
        IE8 support, see AngularJS Internet Explorer Compatibility http://docs.angularjs.org/guide/ie
        For Firefox 3.6, you will also need to include jQuery and ECMAScript 5 shim
    -->
    <!--[if lt IE 9]>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/es5-shim/2.2.0/es5-shim.js"></script>
        <script>
            document.createElement('ui-select');
            document.createElement('ui-select-match');
            document.createElement('ui-select-choices');
        </script>
    <![endif]-->
</head>
<body>
    <div class="container-fluid" style="margin-top: 70px;">
        <div ng-controller="FormController as form" class="row">
            <nav class="navbar navbar-default navbar-fixed-top">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <li class="navbar-brand" href="#">New {{::form.editorModel.table.name | underscoreToSpace | toTitleCase}}</li>
                    </div>
                    <div class="navbar-collapse collapse">
                        <ul class="navbar-form navbar-right" role="button">
                            <div class="input-group">
                                <input ng-model="form.numRowsToAdd" type="number" class="form-control" style="width: 60px;">
                                <span class="input-group-btn">
                                    <button class="btn btn-default" ng-click="form.addFormRow(form.numRowsToAdd);" type="button">Add # of Rows</button>
                                </span>
                            </div><!-- /input-group -->
                            <button class="btn btn-primary pull-right" type="submit" ng-click="form.submit();">Submit Data</button>
                        </ul>
                   </div><!--/.nav-collapse -->
                </div>
            </nav>
            <div class="col-md-12">
                <div ng-show="form.alert" class="row">
                    <div class="col-md-12">
                        <div class="alert alert-dismissible" ng-class="{'alert-danger': form.alert.type == 'error', 'alert-success': form.alert.type == 'success'}" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <strong>{{form.alert.type | underscoreToSpace | toTitleCase}}</strong> {{form.alert.message}}
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <table class="table table-bordered table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th ng-repeat="column in form.editorModel.table.columns.all();" ng-if="!form.isAutoGen(column.type.name);">
                                        {{::column.name | underscoreToSpace | toTitleCase}} &bull; <small>{{::column.type.name}}</small>
                                    </th>
                                </tr>
                            </thead>
                            <tbody ng-form="form.formContainer">
                                    <tr ng-form="form.formContainer.row{{rowIndex}}" ng-repeat="(rowIndex, row) in form.editorModel.rows track by $index">
                                        <td>{{rowIndex + 1}}</td>
                                        <td ng-form="form.formContainer.row{{rowIndex}}.{{column.name}}" ng-repeat="column in form.editorModel.table.columns.all();"
                                            ng-if="!form.isAutoGen(column.type.name);" ng-switch="form.setInputType(column);" novalidate>
                                            <!-- date input -->
                                            <datepicker ng-switch-when="date" date-format="yyyy-MM-dd">
                                                <input ng-model="form.editorModel.rows[rowIndex][column.name]"
                                                    name="{{column.name}}" type="date" class="form-control" required>
                                            </datepicker>
                                            <!-- dropdown select input -->
                                            <div ng-switch-when="dropdown">
                                                <ui-select ng-model="form.editorModel.rows[rowIndex][column.name]" theme="select2" ng-disabled="disabled">
                                                    <ui-select-match name="{{column.name}}" placeholder="Select a value">{{$select.selected | underscoreToSpace | toTitleCase}}</ui-select-match>
                                                    <ui-select-choices repeat="domainValue in form.editorModel.domainValues[column.name] | filter: $select.search" >
                                                        <div ng-bind-html="domainValue | underscoreToSpace | toTitleCase | highlight: $select.search"></div>
                                                    </ui-select-choices>
                                                </ui-select>
                                            </div>
                                            <!-- numeric input -->
                                            <input ng-switch-when="number" ng-model="form.editorModel.rows[rowIndex][column.name]"
                                                name="{{column.name}}" type="number" class="form-control" required integer>
                                            <!-- decimal input -->
                                            <!-- boolean input -->
                                            <input ng-switch-when="boolean" ng-model="form.editorModel.rows[rowIndex][column.name]"
                                                name="{{column.name}}" type="checkbox" class="form-control" required>

                                            <!-- text input -->
                                            <input ng-switch-default ng-model="form.editorModel.rows[rowIndex][column.name]"
                                                name="{{column.name}}" type="text" class="form-control" required>

                                            <div ng-messages="form.formContainer.row{{rowIndex}}.{{column.name}}.$error" ng-show="form.formContainer.$submitted" class="text-danger" role="alert">
                                                <div ng-message="required">Please enter a value for this field.</div>
                                                <div ng-message="date">This field requires a date value.</div>
                                                <div ng-message="number">This field requires a numeric value.</div>
                                            </div>
                                        </td>
                                     </tr>
                             </tbody>
                         </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
